## 2026-01-29 - [Perl Debugger Safe Evaluation Bypass]
**Vulnerability:** The `is_in_single_quotes` function incorrectly identified the old-style Perl package separator `'` (single quote) as the start of a string literal. This allowed dangerous operations like `CORE'system` to bypass the regex-based "Safe Evaluation" filter because they were treated as string contents (e.g., `'system'`) rather than executable code. Additionally, critical keywords (`use`, `no`, `package`, `goto`) were missing from the blocklist.
**Learning:** Regex-based security filters for complex languages like Perl are fragile if they rely on simple tokenization assumptions. The ambiguity of `'` as both a quote delimiter and a package separator is a classic Perl parsing edge case that requires context-aware analysis (checking preceding tokens).
**Prevention:** When implementing "safe evaluation" or sanitization logic for dynamic languages, always verify edge cases in syntax parsing, especially archaic or alternative syntax features. Use robust lexing logic rather than simple regex scanning where possible, or ensure the regex scanner accounts for token context (e.g., preceding word characters).
