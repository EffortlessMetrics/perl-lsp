[package]
name = "perl-parser-pest"
rust-version = "1.89"
version = "0.8.6"
edition = "2024"
description = "Pest-based Perl parser (v2, experimental/legacy); use `perl-parser` (v3) for production"
license = "MIT OR Apache-2.0"
repository = "https://github.com/EffortlessSteven/tree-sitter-perl"
keywords = ["perl", "parser", "pest", "legacy", "v2"]
categories = ["parsing", "text-processing"]

[dependencies]
perl-lexer = { version = "0.8.6" }
tree-sitter = "0.25.8"
tree-sitter-perl = { path = "../tree-sitter-perl-rs", features = ["pure-rust", "test-utils"] }
serde = { version = "1.0.219", features = ["derive"] }
bincode = "2.0.1"
proptest = "1.7.0"
walkdir = "2.5.0"
thiserror = "2.0.12"
unicode-ident = "1.0.18"
unicode-normalization = "0.1.24"
pest = "2.8.1"
pest_derive = "2.8.1"
logos = "0.15.0"
chumsky = "0.10.1"
regex = "1.11.1"
stacker = "0.1.21"
encoding_rs = "0.8.35"
serde_json = "1.0.142"
once_cell = "1.21.3"
lazy_static = "1.5.0"

[dev-dependencies]
criterion = "0.7.0"
test-case = "3.3.1"

[lints.rust]
unused_imports = "warn"
dead_code = "warn"

[lints.clippy]
collapsible_if = "warn"
manual_strip = "warn"
unnecessary_map_or = "warn"
redundant_closure = "warn"
while_let_on_iterator = "warn"
len_zero = "warn"
only_used_in_recursion = "warn"
ptr_arg = "warn"

[package.metadata.docs.rs]
all-features = false
# This is the v2 Pest experiment - use perl-parser (v3) for production

[features]
default = ["pure-rust"]
pure-rust = []
pure-rust-standalone = ["pure-rust"]  # For benchmarking without perl-lexer
token-parser = []
test-utils = []
examples = []  # Gate examples to avoid filename collisions
# Legacy features (for benchmarking only)
c-scanner = []
rust-scanner = []

[lib]
name = "perl_parser_pest"
path = "src/lib.rs"

[[bin]]
name = "bench_parser_pest"
path = "src/bin/bench_parser.rs"
required-features = ["test-utils"]

[[bin]]
name = "compare_parsers_pest"
path = "src/bin/compare_parsers.rs"
required-features = ["test-utils"]

[[bin]]
name = "test_stacker_pest"
path = "src/bin/test_stacker.rs"
required-features = ["pure-rust", "examples"]

[[bin]]
name = "benchmark_parsers_pest"
path = "src/bin/benchmark_parsers.rs"
required-features = ["pure-rust", "examples"]

[[bin]]
name = "test_parsers_pest"
path = "src/bin/test_parsers.rs"
required-features = ["pure-rust", "examples"]

[[bin]]
name = "parse-rust-pest"
path = "src/bin/parse_rust.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_showcase_features"
path = "examples/showcase_features.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_final_demo"
path = "examples/final_demo.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_advanced_features"
path = "examples/advanced_features.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_comprehensive_demo"
path = "examples/comprehensive_demo.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_edge_case_tests"
path = "examples/edge_case_tests.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_supported_edge_cases"
path = "examples/supported_edge_cases.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_heredoc_edge_cases"
path = "examples/heredoc_edge_cases.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_debug_heredoc"
path = "examples/debug_heredoc.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_code_ref"
path = "examples/test_code_ref.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_for_loop"
path = "examples/test_for_loop.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_qq_operators"
path = "examples/test_qq_operators.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_qq_edge_case"
path = "examples/test_qq_edge_case.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_regex_delimiters"
path = "examples/test_regex_delimiters.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_indirect_object"
path = "examples/test_indirect_object.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_anti_pattern_analysis"
path = "examples/anti_pattern_analysis.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_debug_parse"
path = "examples/debug_parse.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_demo_parser"
path = "examples/demo_parser.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_demo_working_parser"
path = "examples/demo_working_parser.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_edge_case_demo"
path = "examples/edge_case_demo.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_simple_lexer_demo"
path = "examples/simple_lexer_demo.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_special_heredoc_usage"
path = "examples/special_heredoc_usage.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_deref_v2"
path = "examples/test_deref_v2.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_enhanced_parser"
path = "examples/test_enhanced_parser.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_format_v2"
path = "examples/test_format_v2.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_parser"
path = "examples/test_parser.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_pest"
path = "examples/test_pest.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_qq_simple"
path = "examples/test_qq_simple.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_test_statement_modifiers_v2"
path = "examples/test_statement_modifiers_v2.rs"
required-features = ["pure-rust", "examples"]

[[example]]
name = "pest_tree_sitter_compatibility"
path = "examples/tree_sitter_compatibility.rs"
required-features = ["pure-rust", "examples"]


[[bench]]
name = "scanner_benchmarks"
path = "../../benches/scanner_benchmarks.rs"
harness = false

[[bench]]
name = "parser_benchmarks"
path = "../../benches/parser_benchmarks.rs"
harness = false

[[bench]]
name = "edge_case_benchmarks"
path = "../../benches/edge_case_benchmarks.rs"
harness = false

[build-dependencies]
cc = "1.2.31"
bindgen = "0.72.0" 