==========================================
Very long identifiers
==========================================

my $this_is_a_very_long_variable_name_that_keeps_going_and_going_and_going_and_going = 1;
sub this_is_an_extremely_long_subroutine_name_that_should_still_be_parsed_correctly_even_though_it_is_ridiculously_long {
    return 42;
}

---

(source_file
  (expression_statement
    (assignment_expression
      (variable_declaration
        (scalar
          (varname)))
      (number)))
  (subroutine_declaration_statement
    (bareword)
    (block
      (expression_statement
        (return_expression
          (number))))))

==========================================
Deeply nested structures
==========================================

$x = [[[[[[[[[[1]]]]]]]]]];
$h = {a=>{b=>{c=>{d=>{e=>{f=>{g=>{h=>{i=>{j=>42}}}}}}}}}};
$r = \\\\\\\\\\\$x;
$d = $a->[0]->{key}->[1]->{another}->[2];

---

(source_file
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (anonymous_array_expression
        (anonymous_array_expression
          (anonymous_array_expression
            (anonymous_array_expression
              (anonymous_array_expression
                (anonymous_array_expression
                  (anonymous_array_expression
                    (anonymous_array_expression
                      (anonymous_array_expression
                        (anonymous_array_expression
                          (number)))))))))))))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (anonymous_hash_expression
        (list_expression
          (autoquoted_bareword)
          (anonymous_hash_expression
            (list_expression
              (autoquoted_bareword)
              (anonymous_hash_expression
                (list_expression
                  (autoquoted_bareword)
                  (anonymous_hash_expression
                    (list_expression
                      (autoquoted_bareword)
                      (anonymous_hash_expression
                        (list_expression
                          (autoquoted_bareword)
                          (anonymous_hash_expression
                            (list_expression
                              (autoquoted_bareword)
                              (anonymous_hash_expression
                                (list_expression
                                  (autoquoted_bareword)
                                  (anonymous_hash_expression
                                    (list_expression
                                      (autoquoted_bareword)
                                      (anonymous_hash_expression
                                        (list_expression
                                          (autoquoted_bareword)
                                          (anonymous_hash_expression
                                            (list_expression
                                              (autoquoted_bareword)
                                              (number)))))))))))))))))))))))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (refgen_expression
        (refgen_expression
          (refgen_expression
            (refgen_expression
              (refgen_expression
                (refgen_expression
                  (refgen_expression
                    (refgen_expression
                      (refgen_expression
                        (refgen_expression
                          (refgen_expression
                            (scalar
                              (varname)))))))))))))))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (array_element_expression
        (hash_element_expression
          (array_element_expression
            (hash_element_expression
              (array_element_expression
                (scalar
                  (varname))
                (number))
              (autoquoted_bareword))
            (number))
          (autoquoted_bareword))
        (number)))))

==========================================
Mixed line endings
==========================================

$unix = "line\n";
$windows = "line\r\n";
$mac = "line\r";
$mixed = "line1\nline2\r\nline3\r";

---

(source_file
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (interpolated_string_literal
        (string_content
          (escape_sequence)))))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (interpolated_string_literal
        (string_content
          (escape_sequence)
          (escape_sequence)))))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (interpolated_string_literal
        (string_content
          (escape_sequence)))))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (interpolated_string_literal
        (string_content
          (escape_sequence)
          (escape_sequence)
          (escape_sequence)
          (escape_sequence))))))

==========================================
Ambiguous parsing situations
==========================================

# Bareword vs string
print bareword;
print "string";
print bareword => "value";

# Function call vs expression
print(1 + 2) * 3;
print (1 + 2) * 3;

# Regex vs division
$x = $y / 2 / 3;
$x = $y /2/3;
$x =~ /2/;

# Hash vs block
sub foo {
    { key => 'value' }
}
map { $_ * 2 } @list;
$hash = { key => 'value' };

---

(source_file
  (comment)
  (expression_statement
    (ambiguous_function_call_expression
      (function)
      (bareword)))
  (expression_statement
    (ambiguous_function_call_expression
      (function)
      (interpolated_string_literal
        (string_content))))
  (expression_statement
    (ambiguous_function_call_expression
      (function)
      (list_expression
        (autoquoted_bareword)
        (interpolated_string_literal
          (string_content)))))
  (comment)
  (expression_statement
    (binary_expression
      (function_call_expression
        (function)
        (binary_expression
          (number)
          (number)))
      (number)))
  (expression_statement
    (binary_expression
      (function_call_expression
        (function)
        (binary_expression
          (number)
          (number)))
      (number)))
  (comment)
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (binary_expression
        (binary_expression
          (scalar
            (varname))
          (number))
        (number))))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (binary_expression
        (binary_expression
          (scalar
            (varname))
          (number))
        (number))))
  (expression_statement
    (binary_expression
      (scalar
        (varname))
      (match_regexp
        (regexp_content))))
  (comment)
  (subroutine_declaration_statement
    (bareword)
    (block
      (expression_statement
        (anonymous_hash_expression
          (list_expression
            (autoquoted_bareword)
            (string_literal
              (string_content)))))))
  (expression_statement
    (map_grep_expression
      (block
        (expression_statement
          (binary_expression
            (scalar
              (varname))
            (number))))
      (array
        (varname))))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (anonymous_hash_expression
        (list_expression
          (autoquoted_bareword)
          (string_literal
            (string_content)))))))

==========================================
Whitespace sensitivity
==========================================

# Spaces in different contexts
$ x = 1;
$x = 1;
$x=1;
$x   =   1;

# Newlines in expressions
$x = 1
  + 2
  + 3;

$y = 
  42;

# Tab characters
$tab	=	"value";
sub	func	{	}

---

(source_file
  (comment)
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (comment)
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (binary_expression
        (binary_expression
          (number)
          (number))
        (number))))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (comment)
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (interpolated_string_literal
        (string_content))))
  (subroutine_declaration_statement
    (bareword)
    (block)))

==========================================
Special parsing contexts
==========================================

# Prototypes with special characters
sub proto($) { }
sub proto2($@) { }
sub proto3(\@$;%) { }
sub proto4(&@) { }

# Attributes with arguments
sub attr : lvalue : method { }
sub attr2 : Foo(bar, baz) { }

# Version strings
use Module 1.23;
use Module v1.2.3;
use Module 1.23_45;

---

(source_file
  (comment)
  (subroutine_declaration_statement
    (bareword)
    (prototype)
    (block))
  (subroutine_declaration_statement
    (bareword)
    (prototype)
    (block))
  (subroutine_declaration_statement
    (bareword)
    (prototype)
    (block))
  (subroutine_declaration_statement
    (bareword)
    (prototype)
    (block))
  (comment)
  (subroutine_declaration_statement
    (bareword)
    (attrlist
      (attribute
        (attribute_name))
      (attribute
        (attribute_name)))
    (block))
  (subroutine_declaration_statement
    (bareword)
    (attrlist
      (attribute
        (attribute_name)
        (attribute_value)))
    (block))
  (comment)
  (use_statement
    (package)
    (number))
  (use_statement
    (package)
    (version))
  (use_statement
    (package)
    (number)))

==========================================
Empty and minimal constructs
==========================================

;
;;
;;;

{}
{;}
{;;}

sub empty { }
sub semi { ; }
sub multi { ;;; }

if (1) { }
while (1) { }
for (;;) { }

()
[]
{}
+{}
+[]

---

(source_file
  (empty_statement)
  (empty_statement)
  (empty_statement)
  (empty_statement)
  (empty_statement)
  (empty_statement)
  (block)
  (block
    (empty_statement))
  (block
    (empty_statement)
    (empty_statement))
  (subroutine_declaration_statement
    (identifier)
    (block))
  (subroutine_declaration_statement
    (identifier)
    (block
      (empty_statement)))
  (subroutine_declaration_statement
    (identifier)
    (block
      (empty_statement)
      (empty_statement)
      (empty_statement)))
  (if_statement
    (condition
      (integer))
    (block))
  (while_statement
    (condition
      (integer))
    (block))
  (for_statement
    (c_style_for_loop
      (empty_statement)
      (empty_statement))
    (block))
  (list_expression)
  (anonymous_array_expression)
  (anonymous_hash_expression)
  (unary_expression
    (unary_operator)
    (anonymous_hash_expression))
  (unary_expression
    (unary_operator)
    (anonymous_array_expression)))

==========================================
Comments in unusual places
==========================================

$x = # comment
  42;

sub func # comment
  (  # comment
    $x, # comment
    $y  # comment
  ) # comment
{ # comment
  return # comment
    $x + $y; # comment
} # comment

$hash = {
  key1 # comment
    => # comment
    'value1', # comment
  # comment between pairs
  key2 => 'value2', # comment
};

---

(source_file
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (comment)
      (number)))
  (subroutine_declaration_statement
    (bareword)
    (comment)
    (signature
      (comment)
      (mandatory_parameter
        (scalar
          (varname)))
      (comment)
      (mandatory_parameter
        (scalar
          (varname)))
      (comment))
    (comment)
    (block
      (comment)
      (expression_statement
        (return_expression
          (comment)
          (binary_expression
            (scalar
              (varname))
            (scalar
              (varname)))))
      (comment)))
  (comment)
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (anonymous_hash_expression
        (list_expression
          (autoquoted_bareword)
          (comment)
          (comment)
          (list_expression
            (string_literal
              (string_content))
            (comment)
            (comment)
            (autoquoted_bareword)
            (string_literal
              (string_content))))
        (comment)))))

==========================================
Numeric edge cases
==========================================

$x = 0;
$x = 00;
$x = 0.0;
$x = .5;
$x = 5.;
$x = 1e10;
$x = 1E10;
$x = 1e+10;
$x = 1e-10;
$x = 1.23e45;
$x = .5e10;
$x = 5.e10;
$x = 0b11111111111111111111111111111111;
$x = 0xFFFFFFFFFFFFFFFF;
$x = 0777777777777;
$x = 999_999_999_999_999_999_999;
$x = 0b1010_1010;
$x = 0x1234_5678_9ABC_DEF0;

---

(source_file
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number)))
  (expression_statement
    (assignment_expression
      (scalar
        (varname))
      (number))))
