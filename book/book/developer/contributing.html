<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Contributing - Perl LSP Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Comprehensive documentation for the perl-lsp project - a production-ready Perl Language Server Protocol implementation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Perl LSP Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/EffortlessMetrics/tree-sitter-perl" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/EffortlessMetrics/tree-sitter-perl/edit/master/docs/src/developer/contributing.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="contributing-to-perl-lsp"><a class="header" href="#contributing-to-perl-lsp">Contributing to Perl LSP</a></h1>
<p>Thank you for your interest in contributing to Perl LSP! This guide will help you get started.</p>
<h2 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h2>
<ol>
<li>
<p><strong>Fork and Clone</strong></p>
<pre><code class="language-bash">git clone https://github.com/your-username/perl-lsp.git
cd perl-lsp
</code></pre>
</li>
<li>
<p><strong>Install Dependencies</strong></p>
<pre><code class="language-bash"># Rust toolchain (if not already installed)
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Install nextest for faster testing
cargo install cargo-nextest
</code></pre>
</li>
<li>
<p><strong>Build the Project</strong></p>
<pre><code class="language-bash">cargo build
cargo test
</code></pre>
</li>
</ol>
<h2 id="development-workflow"><a class="header" href="#development-workflow">Development Workflow</a></h2>
<h3 id="making-changes"><a class="header" href="#making-changes">Making Changes</a></h3>
<ol>
<li>
<p>Create a feature branch:</p>
<pre><code class="language-bash">git checkout -b feature/your-feature-name
</code></pre>
</li>
<li>
<p>Make your changes following our coding standards:</p>
<ul>
<li>Run <code>cargo fmt</code> to format code</li>
<li>Run <code>cargo clippy</code> to check for common issues</li>
<li>Add tests for new functionality</li>
<li>Update documentation as needed</li>
</ul>
</li>
<li>
<p>Test your changes:</p>
<pre><code class="language-bash">cargo nextest run          # Fast test execution
cargo test                 # Traditional test runner
cargo clippy --workspace   # Lint checks
</code></pre>
</li>
<li>
<p>Commit with clear messages:</p>
<pre><code class="language-bash">git commit -m "feat: add new feature X"
git commit -m "fix: resolve issue #123"
</code></pre>
</li>
</ol>
<h3 id="pull-request-process"><a class="header" href="#pull-request-process">Pull Request Process</a></h3>
<ol>
<li><strong>Push your branch</strong> and open a Pull Request</li>
<li><strong>Describe your changes</strong> clearly in the PR description</li>
<li><strong>Link related issues</strong> using GitHub keywords (e.g., “Fixes #123”)</li>
<li><strong>Respond to review feedback</strong> promptly</li>
</ol>
<h2 id="continuous-integration"><a class="header" href="#continuous-integration">Continuous Integration</a></h2>
<p>See <strong><a href="./docs/CI.html">CI &amp; Automation</a></strong> for comprehensive details about our GitHub Actions setup, including:</p>
<ul>
<li><strong>Pinned runner versions</strong> (<code>ubuntu-22.04</code>, <code>windows-2022</code>)</li>
<li><strong>Default CI jobs</strong> that run on every PR</li>
<li><strong>Opt-in CI labels</strong> for heavy jobs (<code>ci:bench</code>, <code>ci:mutation</code>, <code>ci:strict</code>, <code>ci:mac</code>)</li>
<li><strong>Build optimizations</strong> (lean flags, nextest configuration)</li>
<li><strong>Troubleshooting tips</strong> for common CI issues</li>
</ul>
<h3 id="quick-ci-tips"><a class="header" href="#quick-ci-tips">Quick CI Tips</a></h3>
<ul>
<li>All PRs run <strong>format checks</strong>, <strong>clippy</strong>, and <strong>core tests</strong> automatically</li>
<li>Tests use <strong>nextest</strong> with lean build flags for faster, reliable execution</li>
<li>Add <code>ci:bench</code> label to run performance benchmarks</li>
<li>Add <code>ci:strict</code> label for pedantic clippy checks</li>
<li>Add <code>ci:mac</code> label if your changes affect macOS</li>
</ul>
<h3 id="local-ci-validation-while-github-actions-is-unavailable"><a class="header" href="#local-ci-validation-while-github-actions-is-unavailable">Local CI Validation (While GitHub Actions Is Unavailable)</a></h3>
<p><strong>⚠️ IMPORTANT</strong>: GitHub Actions is currently unavailable due to billing issues. During this period:</p>
<ul>
<li><strong>REQUIRED</strong>: Run <code>just ci-gate</code> before every merge</li>
<li><strong>RECOMMENDED</strong>: Run <code>just ci-full</code> for large/structural changes</li>
<li>See <strong><a href="./docs/ci/LOCAL_CI_PROTOCOL.html">Local CI Protocol</a></strong> for complete details</li>
</ul>
<pre><code class="language-bash"># Fast merge gate (~2-5 min, required for all merges)
just ci-gate

# Comprehensive validation (~10-20 min, for large changes)
just ci-full
</code></pre>
<p><strong>Note in PR descriptions</strong>:</p>
<pre><code class="language-markdown">## Local CI Validation
✅ `just ci-gate` passed
See: [Local CI Protocol](docs/ci/LOCAL_CI_PROTOCOL.md)
</code></pre>
<p><strong>Semantic &amp; LSP Changes</strong>:</p>
<p>If you modify <code>crates/perl-parser/src/semantic.rs</code> or any LSP handler (especially <code>textDocument/definition</code>):</p>
<pre><code class="language-bash"># Run semantic-aware definition tests
just ci-lsp-def

# Or run the full gate (includes ci-lsp-def)
just ci-gate
</code></pre>
<p>The semantic tests validate that LSP definition resolution works correctly for:</p>
<ul>
<li>Scalar variable references → declarations</li>
<li>Subroutine calls → sub definitions</li>
<li>Lexical scope resolution</li>
<li>Package-qualified symbol lookups</li>
</ul>
<p>Once GitHub Actions is restored, this section will be archived and normal CI workflow will resume.</p>
<h2 id="coding-standards"><a class="header" href="#coding-standards">Coding Standards</a></h2>
<ul>
<li><strong>Formatting:</strong> Use <code>cargo fmt --all</code> before committing</li>
<li><strong>Linting:</strong> Fix all <code>cargo clippy</code> warnings</li>
<li><strong>Testing:</strong> Maintain or improve test coverage</li>
<li><strong>Documentation:</strong> Update docs for public APIs and new features</li>
<li><strong>Commits:</strong> Use conventional commit format (feat:, fix:, docs:, etc.)</li>
</ul>
<h3 id="code-style-guidelines"><a class="header" href="#code-style-guidelines">Code Style Guidelines</a></h3>
<ul>
<li>Prefer <code>.first()</code> over <code>.get(0)</code> for accessing first element</li>
<li>Use <code>.push(char)</code> instead of <code>.push_str("x")</code> for single characters</li>
<li>Use <code>or_default()</code> instead of <code>or_insert_with(Vec::new)</code> for default values</li>
<li>Avoid unnecessary <code>.clone()</code> on types that implement Copy</li>
<li>Add <code>#[allow(clippy::only_used_in_recursion)]</code> for recursive tree traversal functions</li>
</ul>
<h3 id="cross-platform-exitstatus-in-tests"><a class="header" href="#cross-platform-exitstatus-in-tests">Cross-Platform <code>ExitStatus</code> in Tests</a></h3>
<p>On Unix, <code>ExitStatus::from_raw(1)</code> is <strong>wrong</strong> (needs high-byte encoding). On Windows, the signature doesn’t exist. Always use the portable helpers from <code>crates/perl-parser/src/execute_command.rs</code>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[cfg(test)]
use crate::execute_command::mock_status;

#[test]
fn status_round_trip() {
    assert!(mock_status(0).success());
    assert_eq!(mock_status(1).code(), Some(1));
}
<span class="boring">}</span></code></pre></pre>
<p><strong>Never use</strong> <code>std::process::ExitStatus::from_raw(..)</code> directly in tests/benches - CI will reject it.</p>
<h4 id="pre-commit-hook-optional"><a class="header" href="#pre-commit-hook-optional">Pre-Commit Hook (Optional)</a></h4>
<p>To catch policy violations before pushing, install the pre-commit hook:</p>
<pre><code class="language-bash"># Option 1: Copy hook (manual updates needed)
cp .ci/hooks/pre-commit .git/hooks/pre-commit
chmod +x .git/hooks/pre-commit

# Option 2: Symlink hook (auto-updates with git pull)
ln -sf ../../.ci/hooks/pre-commit .git/hooks/pre-commit
</code></pre>
<h4 id="manual-policy-check"><a class="header" href="#manual-policy-check">Manual Policy Check</a></h4>
<p>Run the policy check locally anytime:</p>
<pre><code class="language-bash">./.ci/scripts/check-from-raw.sh
</code></pre>
<h2 id="project-structure"><a class="header" href="#project-structure">Project Structure</a></h2>
<ul>
<li><strong><code>crates/perl-parser/</code></strong> - Core parser implementation and LSP providers</li>
<li><strong><code>crates/perl-lsp/</code></strong> - LSP server binary and CLI</li>
<li><strong><code>crates/perl-dap/</code></strong> - Debug Adapter Protocol implementation</li>
<li><strong><code>crates/perl-lexer/</code></strong> - Tokenization and lexical analysis</li>
<li><strong><code>crates/perl-corpus/</code></strong> - Test corpus and property-based testing</li>
<li><strong><code>xtask/</code></strong> - Advanced testing and development tools</li>
<li><strong><code>docs/</code></strong> - Comprehensive project documentation</li>
</ul>
<h2 id="testing-guidelines"><a class="header" href="#testing-guidelines">Testing Guidelines</a></h2>
<h3 id="writing-tests"><a class="header" href="#writing-tests">Writing Tests</a></h3>
<ul>
<li>Place tests in <code>tests/</code> directory or inline with <code>#[cfg(test)]</code></li>
<li>Use descriptive test names that explain what is being tested</li>
<li>Test both success and failure cases</li>
<li>Add edge case tests for parser improvements</li>
</ul>
<h3 id="running-tests"><a class="header" href="#running-tests">Running Tests</a></h3>
<pre><code class="language-bash"># Fast parallel testing with nextest
cargo nextest run

# Traditional test runner
cargo test

# Test specific crate
cargo test -p perl-parser

# Test with verbose output
cargo test -- --nocapture

# Run determinism checks
cargo test --test determinism_test
</code></pre>
<h2 id="documentation"><a class="header" href="#documentation">Documentation</a></h2>
<ul>
<li><strong>Public APIs</strong> must have documentation comments (<code>///</code>)</li>
<li><strong>Modules</strong> should have module-level documentation (<code>//!</code>)</li>
<li><strong>Complex functions</strong> should include examples in doc comments</li>
<li>Run <code>cargo doc --no-deps --open</code> to view generated docs</li>
</ul>
<h2 id="dependency-management"><a class="header" href="#dependency-management">Dependency Management</a></h2>
<p>The project uses <strong>Dependabot</strong> for automated dependency updates. Dependabot PRs are created weekly and should be reviewed according to the update type:</p>
<ul>
<li><strong>Patch updates (x.y.Z)</strong> - Can be merged quickly if CI passes</li>
<li><strong>Minor updates (x.Y.0)</strong> - Require changelog review and testing</li>
<li><strong>Major updates (X.0.0)</strong> - Require deep review, migration planning, and comprehensive testing</li>
</ul>
<p>For handling Dependabot PRs:</p>
<pre><code class="language-bash"># View all dependency PRs
gh pr list --label "dependencies"

# Merge passing patch updates
gh pr list --author "app/dependabot" --search "status:success" --json number --jq '.[].number' | \
  xargs -I {} gh pr merge {} --auto --squash
</code></pre>
<p>See <strong><a href="./docs/DEPENDENCY_MANAGEMENT.html">Dependency Management Guide</a></strong> for complete details on:</p>
<ul>
<li>Update strategy and grouping</li>
<li>Review process by update type</li>
<li>Auto-merge configuration</li>
<li>Security update handling</li>
<li>Troubleshooting common issues</li>
</ul>
<p>For quick reference, see <strong><a href="./docs/DEPENDENCY_QUICK_REFERENCE.html">Dependency Quick Reference</a></strong>.</p>
<h2 id="getting-help"><a class="header" href="#getting-help">Getting Help</a></h2>
<ul>
<li><strong>Issues:</strong> Browse existing issues or create a new one</li>
<li><strong>Discussions:</strong> Use GitHub Discussions for questions and ideas</li>
<li><strong>Documentation:</strong> Check <code>docs/</code> for comprehensive guides</li>
<li><strong>Code Examples:</strong> See <code>examples/</code> and test files for usage patterns</li>
</ul>
<h2 id="code-of-conduct"><a class="header" href="#code-of-conduct">Code of Conduct</a></h2>
<p>We follow the Rust Code of Conduct. Please be respectful and constructive in all interactions.</p>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<p>By contributing, you agree that your contributions will be licensed under the same license as the project (typically MIT or Apache-2.0).</p>
<hr />
<p>Thank you for contributing to Perl LSP! =�</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../architecture/modern-architecture.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../developer/commands-reference.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../architecture/modern-architecture.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../developer/commands-reference.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
